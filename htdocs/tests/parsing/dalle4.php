<?php
ob_start();
session_cache_expire(720);
session_start();

define('APPDATA_PATH', dirname(dirname(dirname(__FILE__))) . '/inc_appdata');
define('UPLOAD_PATH', dirname(dirname(dirname(__FILE__))) . '/uploaded_files');
require dirname(APPDATA_PATH) . '/func.inc.php';
require dirname(APPDATA_PATH) . '/func.login.php';

$_string2 = '{
    "completion1": "**Mediterranean Vegetable and Deli Meat Frittata with A Cucumber-Yogurt Salad**\n\nWith the ingredients listed, I am inspired to create a Mediterranean-style dish that is both satisfying and elegant for a lunch or dinner. The recipe is designed for one person and would have a relatively low calorie count due to its focus on vegetables and lean protein.\n\n*Estimated Calories:* Approximately 500 kcal\n*Country/Region of Origin:* Mediterranean\n*Preparation Duration:* 30 minutes\n\n**Ingredients:**\n- 3 eggs (150g)\n- 30g cheese (grated from the cheese block)\n- 30g sliced cheese\n- 50g deli meat (ham or turkey preferred)\n- 1 slice of bread (to make breadcrumbs)\n- Assorted vegetables (e.g., 80g lettuce, 1 small tomato)\n- 100g cucumber\n- 120g yogurt (one container)\n- 1 tbsp butter or margarine (15g)\n- 1 small handful of herbs (parsley or basil, if available)\n- Salt and pepper to taste\n- Olive oil (optional, for better consistency in the yogurt dressing)\n- A pinch of paprika or chili flakes for garnish (optional)\n\n**Instructions:**\n\n_Frittata:_\n\n1. Preheat your oven to 180°C (350°F).\n2. Take the selected vegetables (assume we have a tomato), wash and dice them into small pieces. Wash and chop the lettuce into small shreds. Set aside.\n3. Slice the deli meat into ribbons and set aside.\n4. Crack 3 eggs into a mixing bowl, season with salt and pepper, and beat well.\n5. Grate 30g of cheese from the cheese block and add it to the egg mixture.\n6. In a skillet, melt 1 tbsp of butter or margarine over medium heat.\n7. Toast a slice of bread and crumble it into breadcrumbs. Mix a few breadcrumbs into the egg mixture for added texture (reserve some for topping).\n8. Add the diced vegetables to the skillet, cooking for about 2 to 3 minutes until slightly softened.\n9. Pour the egg mixture over the vegetables, sprinkle with the sliced cheese, and arrange the deli meat on top.\n10. Let it cook without stirring for about 2 minutes until the edges begin to set.\n11. Sprinkle the reserved breadcrumbs on top and transfer the skillet into the preheated oven.\n12. Bake for 15 minutes or until the frittata is set and golden on top.\n\n_Cucumber-Yogurt Salad:_\n\n1. Peel and thinly slice the cucumber.\n2. In the blender, combine 120g yogurt with a touch of olive oil (if available) to create a smoother consistency for the dressing. Season with salt and black pepper.\n3. Mix the sliced cucumber and lettuce shreds in a bowl.\n4. Pour the yogurt dressing over the salad and toss gently to coat.\n\n_Garnish and Serve:_\n\n1. Once the frittata is done, let it cool slightly and then transfer it to a plate.\n2. Serve the cool cucumber-yogurt salad on the side or over the top of the frittata.\n3. If herbs like parsley or basil are available, sprinkle them over the frittata for freshness.\n4. Optionally, dust the frittata with a pinch of paprika or chili flakes for a hint of heat before serving.\n\nThis Mediterranean Vegetable and Deli Meat Frittata with A Cucumber-Yogurt Salad is a high-protein gourmet dish emphasizing the freshness of vegetables and the tanginess of the yogurt dressing, making it a perfect, balanced meal which showcases skilled culinary techniques such as balancing textures with breadcrumbs and perfectly setting a frittata. Enjoy your gourmet creation!",
    "completion2": "As a chef with extensive experience but with no specific recipe provided, I will first create a gourmet recipe based on the ingredients you\'ve provided and then craft four prompt ideas for DALL-E to visualize the dish in a luxurious way.\n\n**Savory Cheesy Baked Egg Vessel**\n\n*Recipe Origin:* Fusion / International\n*Preparation Time:* 45 minutes\n*Calories:* Approximately 600-700 kcal per serving\n\n**Ingredients:**\n- 2 large eggs\n- 60g cheese block, grated\n- 2 tbsp yogurt\n- 1/4 cucumber, sliced thinly\n- 100g mixed vegetables (lettuce, tomatoes), chopped\n- 2 slices of deli meat, chopped\n- 2 slices of bread, crust removed\n- 30g sliced cheese\n- 2 tbsp butter or margarine\n- 1 tbsp orange sauce or spread (optional)\n- Salt and pepper to taste\n- Fresh herbs (like parsley or chives for garnishing, optional)\n\n**Directions:**\n1. Preheat your oven to 180°C (356°F).\n2. Butter a small ovenproof dish. Line the base and sides of the dish with bread slices, trimmed to fit. Press down gently.\n3. In a separate bowl, beat eggs, then mix in yogurt, grated cheese, deli meat, vegetables, and a tablespoon of the orange sauce or spread; season with salt and pepper.\n4. Pour the egg mixture into the bread-lined dish and place sliced cheese on top.\n5. Bake in the oven for approximately 25-30 minutes, or until the egg is set and cheese is golden brown.\n6. Remove from the oven, let it cool slightly, and garnish with fresh herbs if desired.\n7. Serve the baked egg vessel warm, slicing it to reveal the colorful interior.\n\n**DALL-E Photo Prompts:**\n\n1. \"A bowl of vibrant Fancy Fusion Baked Egg Vessel, artfully topped with golden, bubbly cheese and a delicate sprinkle of fresh green herbs, presented on an elegant white porcelain plate against a rustic dark timber surface with a silver fork resting beside.\"\n\n2. \"A plate of meticulously composed Cheesy Baked Egg Vessel with bright, fresh vegetable inclusions, a drizzle of creamy orange sauce creating pleasing patterns atop, photographed with a shallow depth of field to highlight the dish\'s tempting textures.\"\n\n3. \"A bowl of the International Egg Delight, showcasing layers of sumptuous baked egg and cheese, adorned with thin cucumber slices, on a minimalist backdrop with soft natural lighting accentuating the steam wafting from the surface.\"\n\n4. \"A plate of Gourmet Cheesy Egg Creation with a harmonious melange of colorful diced vegetables peeking through, all resting elegantly against a clean, white bone china backdrop, accompanied by a refined glass of chilled sparkling water.\"\n\nThese prompts aim to capture the elegance, textures, colors, and fresh appeal of the dish, presenting it as a luxurious and delectable option that would entice any viewer."
}';
$string2 = '{
    "completion1": "As an AI language model, I am not a gourmet chef myself, but I can certainly channel the knowledge of culinary arts to create a recipe for you. However, the list of ingredients you\'ve provided appears to be descriptions of packaging types rather than actual food ingredients. To create a proper recipe, I\'ll assume that these packages contain common groceries, and I\'ll generate a hypothetical recipe based on what these containers typically hold.\n\nLet\'s say:\n\n- Soda cans - Let\'s assume a can of cola\n- TINE Lettmelk (reduced-fat milk) carton - Reduced-fat milk (500ml)\n- Plastic tub - Cream cheese (200g)\n- Glass jar - Sun-dried tomatoes in oil (150g)\n- Yellow margarine or butter tub - Butter (250g)\n- Larger yellow spread or deli tub - Deli-style mustard (180g)\n- Metal tube - Tomato paste (150g)\n- Plastic bottle - Olive oil (500ml)\n- Blue carton - Fresh heavy cream (250ml)\n- Red plastic bags - Let\'s assume they contain tomatoes (500g) and fresh basil (50g)\n- Additional rectangular box or packaging - Dried pasta (500g)\n\nBased on this assumption, here\'s a gourmet recipe for a dish called \"Sun-Dried Tomato and Basil Chicken Penne in a Creamy Mustard Sauce.\"\n\n### Recipe: Sun-Dried Tomato and Basil Chicken Penne in a Creamy Mustard Sauce\n\n#### Estimated Calories: Approximately 850-900 kcal per serving\n#### Country/Region of Origin: Inspired by Italian Cuisine\n#### Duration of Preparation: 35 minutes\n\n#### Ingredients:\n\n- 120g chicken breast, sliced\n- 90g penne pasta\n- 40g sun-dried tomatoes, chopped\n- 1 tablespoon olive oil (15ml)\n- 2 cloves garlic, minced\n- 30g yellow onion, finely chopped\n- 25g cream cheese\n- 60ml reduced-fat milk\n- 15g deli-style mustard\n- 20g fresh heavy cream\n- 5g butter\n- A small handful of fresh basil leaves, torn\n- Salt and pepper, to taste\n\n#### Optional Ingredients:\n\n- Grated Parmesan cheese for garnishing\n- Chili flakes for extra heat\n\n#### Instructions:\n\n1. **Preheat the oven** to 190°C (375°F).\n\n2. **Season the chicken** with salt and pepper, then sear in a pan over medium heat with olive oil until golden brown. Transfer to a baking dish and **bake in the preheated oven** for about 15-20 minutes or until cooked through. Once done, set aside to rest.\n\n3. **Boil the penne pasta** in salted water according to package directions for al dente.\n\n4. In the same pan used for the chicken, add butter, minced garlic, and chopped onion. Cook over medium heat until the onions are soft and translucent.\n\n5. **Decrease the heat to low**, then **add the cream cheese, reduced-fat milk, and deli-style mustard**, stirring until you have a smooth sauce. Then **stir in the heavy cream** to bring a luxurious texture to the sauce.\n\n6. **Add the chopped sun-dried tomatoes**, and let the sauce simmer gently for 5 minutes. The oils from the sun-dried tomatoes will infuse the sauce with flavor.\n\n7. **Drain the pasta** and add it to the sauce, tossing to coat.\n\n8. Slice the rested chicken and **lay it over the pasta**.\n\n9. **Garnish with torn basil leaves**, and if desired, a sprinkle of Parmesan cheese and/or chili flakes.\n\n10. **Serve immediately**.\n\nEnjoy a balanced fusion of tangy sun-dried tomatoes and aromatic basil in this creamy, indulgent dish. The mustard adds a delightful depth to the sauce, making it a truly gourmet lunch or dinner for one.",
    "completion2": "Given the constraints, it is necessary to invent a recipe using the ingredients provided in the list above as a metaphorical base since the items listed are packaging materials, not actual food ingredients. With a gourmet perspective and over 50 years of experience, I will craft a fictional recipe, then provide four prompt ideas for DALL-E to imagine the dish.\n\n**Recipe: Oven-Baked Herbed Chicken with Creamy Mushroom Sauce**\n\n*Ingredients:*\n- One chicken breast (approx. 150g)\n- 200g mixed mushrooms, sliced (e.g., button, shiitake, oyster)\n- 1 tablespoon olive oil\n- 1 clove garlic, minced\n- 100ml TINE Lettmelk (reduced-fat milk)\n- 1 tablespoon flour\n- 1 tablespoon fresh thyme, chopped\n- 1 tablespoon fresh parsley, chopped\n- 30g butter\n- A pinch of salt\n- A pinch of pepper\n- Optional: 50ml white wine for deglazing\n\n*Recipe Origin:* Western Europe\n\n*Preparation Time:* 35 minutes\n\n*Estimation of Calories:* 450-550 kcal\n\n*Instructions:*\n1. Preheat the oven to 200°C (392°F).\n2. Season the chicken breast with salt, pepper, and half of the chopped herbs.\n3. Heat olive oil in a pan over medium heat and sear the chicken on both sides until golden brown.\n4. Place the seared chicken in an ovenproof dish and bake for about 20-25 minutes or until cooked through.\n5. In the same pan, add butter and garlic. Sauté the mushrooms until they are lightly browned.\n6. Sprinkle flour over the mushrooms and cook for 1-2 minutes.\n7. If using, add white wine to deglaze the pan, scraping any browned bits off the bottom.\n8. Gradually whisk in the Lettmelk and remaining herbs. Cook until the sauce thickens.\n9. Remove the chicken from the oven and allow it to rest for a few minutes.\n10. Place the chicken on a plate and pour the creamy mushroom sauce over the top.\n11. Garnish with additional fresh herbs if desired.\n\n**Prompt Ideas for DALL-E:**\n\n1. \"A plate of Oven-Baked Herbed Chicken with Creamy Mushroom Sauce, highlighted by warm backlighting to cast a golden hue over the tender, juicy chicken breast, surrounded by a savory, velvety sauce nestled amidst an elegant ceramic dish with fresh herbs garnishing the top.\"\n\n2. \"A bowl of succulent, golden-browned Herbed Chicken bathed in a rich and creamy Mushroom Sauce, served on a dark slate surface to contrast the lush green parsley and thyme, with an ivory linen napkin and silver cutlery framing the luxurious dish.\"\n\n3. \"A plate of perfectly oven-baked Herbed Chicken with a silken Creamy Mushroom Sauce, presented in a minimalist setting, featuring pure white dinnerware on a rough-hewn wooden table to emphasize the rustic yet refined essence of the dish.\"\n\n4. \"A bowl of aromatic Herbed Chicken crowned with a luscious Creamy Mushroom Sauce, the steam delicately wafting above, set against a backdrop of soft-focus vintage kitchenware and a bouquet of fresh thyme in a crystal-clear glass vase, invoking a sense of home-cooked opulence.\""
}';
$_string2 = '{
    "completion_reciepe": "DISH: Cheesy Ham and Vegetable Pasta Bake\n\nCALORIES: Approximately 400 calories per serving\n\nORIGIN: Italy\n\nPREPARATION TIME: 45 minutes\n\nIngredients:\n- 300g pasta\n- 150g cold cuts (ham)\n- 200g block of cheese\n- 1 plastic bag of mixed vegetables\n- 200ml TINE Lettmelk\n- 100g spreadable cheese\n- 50g Kavli soft cheese\n- Salt and pepper to taste\n\nOptional ingredients:\n- 1 can of pickled jalapeños for an added kick\n- 1/4 cup of sour cream for creaminess\n\nInstructions:\n1. Preheat the oven to 180°C (350°F).\n2. Cook the pasta according to the package instructions. Drain and set aside.\n3. In a saucepan, heat the TINE Lettmelk over low heat. Stir in the spreadable cheese, Kavli soft cheese, salt, and pepper until melted and smooth.\n4. Chop the cold cuts into small pieces and add them to the cheese mixture. Cook for 2-3 minutes until heated through.\n5. In a large bowl, mix together the cooked pasta, cheese and meat mixture, mixed vegetables, and pickled jalapeños if using.\n6. Transfer the mixture to a baking dish. Grate the block of cheese and sprinkle it on top of the pasta.\n7. Bake in the preheated oven for 20-25 minutes or until the cheese is melted and bubbly.\n8. Serve hot and enjoy!\n\nNote: This Cheesy Ham and Vegetable Pasta Bake is a comforting and filling dish that can be served as a main course for lunch or dinner. Feel free to customize it with your favorite vegetables or additional toppings. The clear drawer containing hidden items may hold additional ingredients to enhance the dish further.",
    "completion2": "1. A plate of Cheesy Ham and Vegetable Pasta Bake surrounded by vibrant green herbs and red chili flakes, creating a colorful and appetizing scene.\n\n2. A bowl of Cheesy Ham and Vegetable Pasta Bake with a golden crust of melted cheese, oozing with creamy sauce, showcasing the irresistible texture and cheesy goodness of the dish.\n\n3. A plate of Cheesy Ham and Vegetable Pasta Bake presented on a rustic wooden table, garnished with fresh basil leaves and a drizzle of olive oil, evoking a warm and inviting feeling of a homemade Italian meal.\n\n4. A bowl of Cheesy Ham and Vegetable Pasta Bake captured from a bird\'s-eye view, featuring the layers of pasta, vegetables, and gooey cheese, creating a visually appealing and mouth-watering shot that highlights the comforting essence of the dish.",
    "completion_short_prompts": "1. Plate of Cheesy Ham and Veg Pasta Bake with herbs and chili flakes.\n2. Bowl of Cheesy Ham and Veg Pasta Bake with melted cheese crust.\n3. Plate of Cheesy Ham and Veg Pasta Bake on wooden table with basil and olive oil.\n4. Bowl of Cheesy Ham and Veg Pasta Bake from bird\'s-eye view with layers of pasta and cheese."
}';

$json = json_decode($string2,1);

echo '<pre>' . $json['completion2'] . '</pre>';


$reciepe = openai__find_reciepe_in_completion($json['completion2']);
echo '<hr><pre>' . $reciepe . '</pre>';


$dalle_prompts = openai__find_prompts_in_completion($json['completion2']);
echo '<hr><pre>';
echo json_encode($dalle_prompts, JSON_PRETTY_PRINT | JSON_UNESCAPED_UNICODE | JSON_UNESCAPED_SLASHES);
echo '</pre>';
